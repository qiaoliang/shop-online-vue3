# 纠正路线任务

## 目的

- 使用 `.bmad-core/checklists/change-checklist` 指导对变更触发器的结构化响应。
- 在清单结构的指导下，分析变更对史诗、项目工件和 MVP 的影响。
- 探索潜在的解决方案（例如，调整范围、回滚元素、重新确定功能范围），如清单所提示。
- 根据分析，起草对任何受影响的项目工件（例如，史诗、用户故事、PRD 部分、架构文档部分）的具体、可操作的拟议更新。
- 生成一份合并的“冲刺变更提案”文档，其中包含影响分析和清晰起草的拟议编辑，以供用户审查和批准。
- 如果变更的性质需要其他核心代理（如 PM 或架构师）进行根本性重新规划，则确保清晰的交接路径。

## 说明

### 1. 初始设置和模式选择

- **确认任务和输入：**
  - 与用户确认正在启动“纠正路线任务”（变更导航和集成）。
  - 验证变更触发器，并确保您拥有用户对问题及其感知影响的初步解释。
  - 确认可以访问所有相关的项目工件（例如，PRD、史诗/故事、架构文档、UI/UX 规范），以及关键的 `.bmad-core/checklists/change-checklist`。
- **建立交互模式：**
  - 询问用户在此任务中首选的交互模式：
    - **“增量式（默认和推荐）：** 我们是否逐节检查变更清单，讨论发现并协作起草每个相关部分的拟议更改，然后再进入下一部分？这允许进行详细的、循序渐进的完善。”
    - **“YOLO 模式（批量处理）：** 或者，您是否希望我根据清单进行更批量的分析，然后提出一组合并的发现和拟议更改以进行更广泛的审查？这对于初步评估可能更快，但可能需要对合并的提案进行更广泛的审查。”
  - 一旦用户选择，确认所选模式，然后通知用户：“我们现在将使用变更清单来分析变更并起草拟议更新。我将根据我们选择的交互模式指导您完成清单项目。”

### 2. 执行清单分析（根据交互模式，迭代或批量）

- 系统地完成变更清单的第 1-4 节（通常涵盖变更上下文、史诗/故事影响分析、工件冲突解决和路径评估/建议）。
- 对于每个清单项目或逻辑项目组（取决于交互模式）：
  - 向用户呈现清单中的相关提示或考虑事项。
  - 请求必要的信息并积极分析相关的项目工件（PRD、史诗、架构文档、故事历史等）以评估影响。
  - 与用户讨论您对每个项目的发现。
  - 记录每个清单项目的状态（例如，`[x] 已处理`、`[N/A]`、`[!] 需要进一步操作`）以及任何相关的注释或决定。
  - 协作商定“推荐的前进路径”，如清单第 4 节所提示。

### 3. 起草拟议更改（迭代或批量）

- 根据已完成的清单分析（第 1-4 节）和商定的“推荐的前进路径”（不包括需要立即移交给 PM/架构师进行根本性重新规划的场景）：
  - 识别需要更新的特定项目工件（例如，特定史诗、用户故事、PRD 部分、架构文档组件、图表）。
  - **直接且明确地为每个已识别的工件起草拟议更改。** 示例包括：
    - 修订用户故事文本、验收标准或优先级。
    - 在史诗中添加、删除、重新排序或拆分用户故事。
    - 提出修改后的架构图片段（例如，提供更新的 Mermaid 图块或对现有图的更改的清晰文本描述）。
    - 更新技术列表、配置详细信息或 PRD 或架构文档中的特定部分。
    - 如果需要，起草新的小型支持工件（例如，针对特定决策的简要附录）。
  - 如果处于“增量模式”，则在起草这些拟议编辑时，与用户讨论并完善每个工件或一小组相关工件的这些拟议编辑。
  - 如果处于“YOLO 模式”，则编译所有起草的编辑以在下一步中呈现。

### 4. 生成带编辑的“冲刺变更提案”

- 将完整的变更清单分析（涵盖第 1-4 节的发现）和所有商定的拟议编辑（来自说明 3）综合到一份名为“冲刺变更提案”的文档中。此提案应与变更清单第 5 节建议的结构保持一致。
- 提案必须清晰地呈现：
  - **分析摘要：** 对原始问题、其分析影响（对史诗、工件、MVP 范围）以及所选前进路径的理由的简明概述。
  - **具体的拟议编辑：** 对于每个受影响的工件，清晰地显示或描述确切的更改（例如，“将故事 X.Y 从：[旧文本] 更改为：[新文本]”，“向故事 A.B 添加新的验收标准：[新 AC]”，“将架构文档的第 3.2 节更新如下：[新/修改的文本或图表描述]”）。
- 向用户呈现“冲刺变更提案”的完整草稿，以供最终审查和反馈。合并用户请求的任何最终调整。

### 5. 最终确定并确定后续步骤

- 获得用户对“冲刺变更提案”的明确批准，包括其中记录的所有具体编辑。
- 向用户提供最终的“冲刺变更提案”文档。
- **根据批准的更改的性质：**
  - **如果批准的编辑充分解决了变更并且可以直接实施或由 PO/SM 组织：** 说明“纠正路线任务”在分析和变更提案方面已完成，用户现在可以继续实施或记录这些更改（例如，更新实际项目文档、待办事项）。如果合适，建议移交给 PO/SM 代理进行待办事项组织。
  - **如果分析和拟议路径（根据清单第 4 节和可能的第 6 节）表明变更需要更根本的重新规划（例如，重大范围变更、重大架构返工）：** 清晰地说明此结论。建议用户下一步涉及与主要 PM 或架构师代理合作，使用“冲刺变更提案”作为该更深入重新规划工作的关键输入和上下文。

## 输出交付物

- **主要：** 一份“冲刺变更提案”文档（markdown 格式）。此文档将包含：
  - 变更清单分析的摘要（问题、影响、所选路径的理由）。
  - 针对所有受影响的项目工件的具体、清晰起草的拟议编辑。
- **隐式：** 一份带注释的变更清单（或其完成记录），反映了在此过程中进行的讨论、发现和决定。
